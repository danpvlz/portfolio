---
import Section from "../Section.astro";
import Title from "../Title.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import LinkTo from "../LinkTo.astro";

interface Props {
  isPreview?: boolean;
}

const { isPreview = false } = Astro.props;

const works = (await getCollection("work")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Section id="work">
  <div class="flex flex-col md:flex-row justify-between">
    <Title title="Work" />
    <LinkTo
      link="/work"
      newPage={false}
      extraClasses={`${isPreview ? 'hidden md:flex' : 'hidden'} font-medium text-center`}
    >
      Check more of my work
    </LinkTo>
  </div>
  <ul class={`grid grid-cols-1 md:grid-cols-2 gap-12 mb-6`} transition:animate="fade">
    {
      works
        .filter((_, i) => (isPreview ? i < 4 : true))
        .map((work) => (
          <li class="group w-full aspect-video rounded-2xl group text-white">
            <a href={`/work/${work.slug}/`}>
              <div class="w-full h-full rounded-2xl shadow-xl overflow-hidden">
                <img
                  transition:name={`workimage ${work.slug}`}
                  src={work.data.heroImage}
                  class="rounded-2xl w-full h-full object-cover object-top group-hover:scale-105 transition-all duration-500"
                />
              </div>
              <div class="font-medium mt-4">
                <p class="text-xl flex items-center gap-0 group-hover:gap-2 group-hover:text-green-theme">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-0 h-6 group-hover:w-8 transition-all duration-300"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"
                    />
                  </svg>
                  {work.data.title}
                </p>
                <p class="text-lg text-[#A7A7A7]">{work.data.description}</p>
              </div>
            </a>
          </li>
        ))
    }
  </ul>
  <LinkTo
    link="/work"
    newPage={false}
    extraClasses={`${isPreview ? 'flex md:hidden' : 'hidden'} font-medium text-center mx-auto`}
  >
    Check more of my work
  </LinkTo>
</Section>
